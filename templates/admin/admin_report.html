{% extends "base.html" %}
{% block title %}Admin Report - Township Clinic{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin_report.css') }}">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
<div class="dashboard-content">
    <h2>Admin Report Summary</h2>

    <div class="panels" aria-label="System Statistics">
        <div class="card stat-card">
            <h3>Total Users</h3>
            <p>{{ total_users }}</p>
        </div>
        <div class="card stat-card">
            <h3>Total Doctors</h3>
            <p>{{ total_doctors }}</p>
        </div>
        <div class="card stat-card">
            <h3>Total Nurses</h3>
            <p>{{ total_nurses }}</p>
        </div>
        <div class="card stat-card">
            <h3>Total Receptionists</h3>
            <p>{{ total_receptionists }}</p>
        </div>
        <div class="card stat-card">
            <h3>Total Patients</h3>
            <p>{{ total_patients }}</p>
        </div>
        <div class="card stat-card">
            <h3>Monthly Appointments</h3>
            <p>{{ monthly_appointments_total }}</p>
        </div>
        <div class="card stat-card">
            <h3>Pending Appointments</h3>
            <p>{{ pending_appointments }}</p>
        </div>
        <div class="card stat-card">
            <h3>Completed Appointments</h3>
            <p>{{ completed_appointments }}</p>
        </div>
        <div class="card stat-card">
            <h3>Missed Appointments</h3>
            <p>{{ missed_appointments }}</p>
        </div>
        <div class="card stat-card">
            <h3>Monthly Revenue</h3>
            <p>${{ monthly_revenue }}</p>
        </div>
    </div>

    <div class="charts-container">
        <div class="chart-box">
            <h3>Staff Distribution</h3>
            <canvas id="staffPieChart"></canvas>
        </div>

        <div class="chart-box">
            <h3>Appointments Status</h3>
            <canvas id="appointmentBarChart"></canvas>
        </div>

        <div class="chart-box full-width-chart">
            <h3>Monthly Appointments Trend</h3>
            <canvas id="monthlyLineChart"></canvas>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/admin_report.js') }}"></script>
<script>
  // Pass Python variables to JS (make sure these are JSON serialized in backend)
  window.staffPieData = {{ staff_pie_data_json|safe }};
  window.appointmentBarData = {{ appointment_bar_data_json|safe }};
  window.monthlyAppointmentsData = {{ monthly_appointments_data_json|safe }};
</script>
{% endblock %}
