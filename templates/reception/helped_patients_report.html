{% extends 'base.html' %}
{% block title %}Helped Patients Report - Township Clinic{% endblock %}
{% block content %}
<div class="container mx-auto px-4 py-8 dashboard-content">
    <h2 class="text-3xl font-bold mb-8">Helped Patients Report</h2>
    {% if helped_patients %}
    <table class="w-full table-auto border-collapse table">
        <thead class="bg-gray-100">
            <tr>
                <th class="px-4 py-2 text-left">ID</th>
                <th class="px-4 py-2 text-left">Patient</th>
                <th class="px-4 py-2 text-left">Appointment Date</th>
                <th class="px-4 py-2 text-left">Nurse</th>
                <th class="px-4 py-2 text-left">Timestamp</th>
                <th class="px-4 py-2 text-left">Reason</th>
                <th class="px-4 py-2 text-left">Notes</th>
            </tr>
        </thead>
        <tbody>
            {% for patient in helped_patients %}
            <tr class="hover:bg-gray-50">
                <td class="px-4 py-2">{{ patient.id }}</td>
                <td class="px-4 py-2">{{ patient.patient_name }}</td>
                <td class="px-4 py-2">{{ patient.appointment_date }}</td>
                <td class="px-4 py-2">{{ patient.nurse_name }}</td>
                <td class="px-4 py-2">{{ patient.helped_timestamp }}</td>
                <td class="px-4 py-2">{{ patient.reason or 'Not specified' }}</td>
                <td class="px-4 py-2">{{ patient.notes }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="text-center text-gray-600">No helped patients found.</p>
    {% endif %}
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    // Fetch JSON data for React frontend if needed
    fetch('/helped_patients_report', {
        headers: { 'Accept': 'application/json' },
        credentials: 'include'
    })
    .then(response => response.json())
    .then(data => {
        console.log('Helped Patients:', data.helped_patients);
    })
    .catch(error => console.error('Error fetching report data:', error));
</script>
{% endblock %}