{% extends "base.html" %}
{% block title %}Edit Profile - Township Clinic{% endblock %}
{% block content %}
<div class="container mx-auto px-4 py-8">
    <section class="bg-white rounded-lg shadow-md p-6 dashboard-content">
        <h2 class="text-3xl font-bold mb-6">Edit Profile</h2>
        <form id="edit-profile-form" method="POST" action="{{ url_for('edit_employee') }}" enctype="multipart/form-data" class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="form-group">
                <label for="first_name" class="block text-sm font-medium text-gray-700">First Name</label>
                <input type="text" id="first_name" name="first_name" value="{{ user_details.get('first_name', '') }}" required class="mt-1 p-2 w-full border rounded-md">
            </div>
            <div class="form-group">
                <label for="last_name" class="block text-sm font-medium text-gray-700">Last Name</label>
                <input type="text" id="last_name" name="last_name" value="{{ user_details.get('last_name', '') }}" required class="mt-1 p-2 w-full border rounded-md">
            </div>
            <div class="form-group">
                <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                <input type="email" id="email" name="email" value="{{ user_details.get('email', '') }}" required class="mt-1 p-2 w-full border rounded-md">
            </div>
            <div class="form-group">
                <label for="phone" class="block text-sm font-medium text-gray-700">Phone Number</label>
                <input type="tel" id="phone" name="phone" value="{{ user_details.get('phone', '') }}" class="mt-1 p-2 w-full border rounded-md">
            </div>
            <div class="form-group md:col-span-2">
                <label for="profile_image" class="block text-sm font-medium text-gray-700">Profile Image</label>
                <input type="file" id="profile_image" name="profile_image" accept="image/*" onchange="previewImage(event)" class="mt-1 p-2 w-full border rounded-md">
                <img id="imagePreview" src="{{ url_for('static', filename='profile_images/' + user_details.get('profile_image', 'default.jpg')) }}" alt="Profile Preview" class="mt-4 max-w-xs rounded-md shadow-sm">
            </div>
            <div class="form-actions md:col-span-2 flex justify-end gap-4">
                <button type="submit" class="btn btn-primary">Save Changes</button>
                {% if session.get('role') == 'admin' %}
                    <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary">Back to Dashboard</a>
                {% elif session.get('role') == 'doctor' %}
                    <a href="{{ url_for('doctor_dashboard') }}" class="btn btn-secondary">Back to Dashboard</a>
                {% elif session.get('role') == 'nurse' %}
                    <a href="{{ url_for('nurse_dashboard') }}" class="btn btn-secondary">Back to Dashboard</a>
                {% elif session.get('role') == 'receptionist' %}
                    <a href="{{ url_for('reception_dashboard') }}" class="btn btn-secondary">Back to Dashboard</a>
                {% else %}
                    <a href="{{ url_for('login_page') }}" class="btn btn-secondary">Back to Login</a>
                {% endif %}
            </div>
        </form>
    </section>
</div>
<script>
    function previewImage(event) {
        const reader = new FileReader();
        reader.onload = function() {
            const preview = document.getElementById('imagePreview');
            preview.src = reader.result;
        };
        reader.readAsDataURL(event.target.files[0]);
    }
</script>
{% endblock %}